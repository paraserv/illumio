[Logging]
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL = INFO

# Maximum size of each log file in bytes before it gets rotated
MAX_LOG_SIZE = 10485760

# Number of backup log files to keep
BACKUP_COUNT = 5

# Log format for file logging
FILE_LOG_FORMAT = %(asctime)s - %(name)s - %(levelname)s - %(message)s

# Log format for console logging
CONSOLE_LOG_FORMAT = %(asctime)s - %(levelname)s - %(message)s

# Enable logging of sample syslog messages (True/False)
ENABLE_SAMPLE_LOGGING = True

# Interval for logging sample syslog messages (in seconds)
SAMPLE_LOG_INTERVAL = 60

# Number of characters to log from sample syslog message
SAMPLE_LOG_LENGTH = 1000

[General]
# Name of the beat for identification in logs
BEATNAME = IllumioS3

[Paths]
# Folder for downloaded log files (relative to BASE_FOLDER)
DOWNLOADED_FILES_FOLDER = illumio

# Folder for application logs (relative to BASE_FOLDER)
LOG_FOLDER = logs

# State file to store processed keys (relative to script directory)
STATE_FILE = state.json

[Syslog]
# IP address or hostname of the syslog server
SMA_HOST = 10.20.1.215

# Port number of the syslog server
SMA_PORT = 514

# Use TCP instead of UDP for syslog transmission (True/False)
USE_TCP = True

# Maximum length of syslog messages in bytes
MAX_MESSAGE_LENGTH = 2048

# Minimum number of syslog messages to send per second
MIN_MESSAGES_PER_SECOND = 5

# Maximum number of syslog messages to send per second
MAX_MESSAGES_PER_SECOND = 100

# Enable or disable dynamic adjustments for syslog rate
ENABLE_DYNAMIC_SYSLOG_RATE = False

# Baseline period for dynamic adjustments (in seconds)
BASELINE_PERIOD = 300

[Processing]
# Number of concurrent threads for processing
MIN_WORKERS = 1
MAX_WORKERS = 5

# Number of logs fetched per worker
BATCH_SIZE = 5
# MIN_BATCH_SIZE = 1
# MAX_BATCH_SIZE = 20

# Time span for which logs are fetched from S3 (in hours)
# MIN_TIMEFRAME = 0.25
# MAX_TIMEFRAME = 24

# Enable or disable dynamic adjustments
# ENABLE_DYNAMIC_BATCH_SIZE = False
# ENABLE_DYNAMIC_WORKERS = False
# ENABLE_DYNAMIC_TIMEFRAME = False

# Time window in hours to look back for new logs
TIME_WINDOW_HOURS = 24.0

# Adjustment interval for dynamic adjustments (in seconds)
ADJUSTMENT_INTERVAL = 60

# Maximum size of the log queue
MAX_QUEUE_SIZE = 100000

# Threshold for queue size warning
QUEUE_SIZE_THRESHOLD = 80000

# Sleep time for queue processing thread when queue is empty (in seconds)
QUEUE_EMPTY_SLEEP_TIME = 0.1

# Sleep time for queue processing thread when rate limit is reached (in seconds)
RATE_LIMIT_SLEEP_TIME = 0.01

[S3]
# Time range in minutes to look back for logs
MINUTES = 2880

# Maximum number of files to process per folder
MAX_FILES_PER_FOLDER = 1000

# Sleep interval in seconds between checks
POLL_INTERVAL = 30

# Base paths for log files in S3
BASE_PATHS = illumio/summaries/,illumio/auditable_events/

# Maximum number of connections in the AWS S3 client connection pool
MAX_POOL_CONNECTIONS = 10

[HealthReporting]
# Interval for sending heartbeat messages (in seconds)
HEARTBEAT_INTERVAL = 30

# Interval for sending summary messages (in seconds)
SUMMARY_INTERVAL = 30

# Enable health reporter
ENABLE_HEALTH_REPORTER = True

[QueueMonitoring]
# Interval for monitoring queue (in seconds)
MONITOR_INTERVAL = 5.0

[DetailedReporting]
# Interval for detailed reporting (in seconds)
REPORT_INTERVAL = 300

[Shutdown]
# Timeout for shutdown process (in seconds)
SHUTDOWN_TIMEOUT = 30

# Timeout for draining the queue during shutdown (in seconds)
QUEUE_DRAIN_TIMEOUT = 60